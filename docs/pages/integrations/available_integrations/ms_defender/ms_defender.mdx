# Microsoft Defender

This integration gives combined access to the following Microsoft security products:

-   [Microsoft Defender XDR](https://learn.microsoft.com/en-us/defender-xdr/investigate-alerts)
-   [Microsoft Defender for Cloud Apps](https://learn.microsoft.com/en-us/defender-cloud-apps/what-is-defender-for-cloud-apps)
-   [Microsoft Defender for Endpoint](https://learn.microsoft.com/en-us/defender-endpoint/microsoft-defender-endpoint)
-   [Microsoft Defender Vulnerability Management](https://learn.microsoft.com/en-us/defender-vulnerability-management/defender-vulnerability-management)
-   [Microsoft Defender for Identity](https://learn.microsoft.com/en-us/defender-for-identity/alerts-overview)
-   [App Governance](https://learn.microsoft.com/en-us/defender-cloud-apps/app-governance-manage-app-governance)
-   [Microsoft Defender for Office 365](https://learn.microsoft.com/en-us/defender-office-365/mdo-about?view=o365-worldwide&preserve-view=true)
-   [Microsoft Purview Data Loss Prevention](https://learn.microsoft.com/en-us/purview/dlp-learn-about-dlp?view=o365-worldwide&preserve-view=true)
-   [Microsoft Entra ID Protection](https://learn.microsoft.com/en-us/entra/id-protection/overview-identity-protection)

## App Registration Connection

Permissions Needed:

-   Alerts: SecurityAlert.ReadWrite.All
-   Incidents: SecurityIncident.ReadWrite.All
-   run hunting query: ThreatHunting.Read.All

Admin Consent Needed

1. Go to your [Azure Portal](https://portal.azure.com/) and login.

2. Go to **Microsoft Entra ID**.

3. In the left menu, click on **App registrations**.

4. Click on **New registration**.

5. Name your app, e.g. `admyral-azure-integration` and click on **Register**.

6. Copy your **Client ID** and **Tenant ID**.

<img src="/ms_defender_for_cloud1.png" />

7. In the left menu, click on **Certificates & secrets** and then on **New client secret**.

8. Copy the **Value** of the secret.

9. In the left menu, click on **API permissions** and then on **Add a permission**.

10. Click on **Microsoft Graph** and then on **Application Permissions**.

11. Select the following permissions:

    - `SecurityAlert.ReadWrite.All`
    - `SecurityIncident.ReadWrite.All`
    - `ThreatHunting.Read.All`

12. Click on **Grant admin consent**.

<img src="/ms_defender_admin_consent.png" />

13. In **Admyral**, go to the **Settings** page and click on **Create New Credential**. Select **Microsoft Defender**.

14. Give your credentials a name, e.g. `MS Defender`. Fill in the **Client ID**, **Tenant ID**, and **Client Secret**. Click on **Save Credential**.
